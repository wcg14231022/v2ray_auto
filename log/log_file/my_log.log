log file2023-05-31 00:42:38,189 - log.my_log - INFO - 开始初始化环境信息
2023-05-31 00:42:38,190 - log.my_log - INFO - 用户参数: {
    "server_ip": "143.198.94.159",
    "server_port": "22",
    "server_username": "root",
    "server_password": "##19960310wcgWCG",
    "os": "centos"
}
2023-05-31 00:42:38,190 - log.my_log - INFO - 初始化环境信息完成
2023-05-31 00:42:38,190 - log.my_log - INFO - 开始登录服务器
2023-05-31 00:42:42,240 - log.my_log - INFO - 登录服务器完成
2023-05-31 00:42:42,240 - log.my_log - INFO - 开始切换到root用户
2023-05-31 00:42:43,329 - log.my_log - INFO - [143.198.94.159: 22]: echo ##19960310wcgWCG | sudo -S su


2023-05-31 00:42:43,330 - log.my_log - INFO - 切换到root用户完成
2023-05-31 00:42:43,330 - log.my_log - INFO - 开始更新服务器
2023-05-31 00:42:44,353 - log.my_log - INFO - [143.198.94.159: 22]: pwd
/root

2023-05-31 00:42:45,414 - log.my_log - INFO - [143.198.94.159: 22]: cat /etc/os-release | grep -E "^ID="
ID="centos"

2023-05-31 00:42:45,414 - log.my_log - INFO - Linux操作系统类型: centos
2023-05-31 00:42:49,041 - log.my_log - INFO - [143.198.94.159: 22]: sudo yum update -y
DigitalOcean Droplet Agent                       10 kB/s | 3.3 kB     00:00    
Dependencies resolved.
Nothing to do.
Complete!

2023-05-31 00:42:49,041 - log.my_log - INFO - 更新服务器完成
2023-05-31 00:42:49,042 - log.my_log - INFO - 开始自动安装Python
2023-05-31 00:42:51,724 - log.my_log - INFO - [143.198.94.159: 22]: sudo yum install python3 -y
Last metadata expiration check: 0:00:03 ago on Tue 30 May 2023 04:42:48 PM UTC.
Package python3-3.9.16-1.el9.x86_64 is already installed.
Dependencies resolved.
Nothing to do.
Complete!

2023-05-31 00:42:51,725 - log.my_log - INFO - 自动安装Python完成
2023-05-31 00:42:51,725 - log.my_log - INFO - 开始自动安装pip
2023-05-31 00:42:53,832 - log.my_log - INFO - [143.198.94.159: 22]: sudo yum install python3-pip -y
Last metadata expiration check: 0:00:05 ago on Tue 30 May 2023 04:42:48 PM UTC.
Package python3-pip-21.2.3-6.el9.noarch is already installed.
Dependencies resolved.
Nothing to do.
Complete!

2023-05-31 00:42:53,832 - log.my_log - INFO - 自动安装pip完成
2023-05-31 00:42:53,832 - log.my_log - INFO - 开始安装git
2023-05-31 00:42:55,896 - log.my_log - INFO - [143.198.94.159: 22]: sudo yum install git -y
Last metadata expiration check: 0:00:07 ago on Tue 30 May 2023 04:42:48 PM UTC.
Package git-2.39.1-1.el9.x86_64 is already installed.
Dependencies resolved.
Nothing to do.
Complete!

2023-05-31 00:42:55,896 - log.my_log - INFO - 安装git完成
2023-05-31 00:42:55,896 - log.my_log - INFO - 开始克隆v2ray-auto代码
2023-05-31 00:42:56,984 - log.my_log - INFO - [143.198.94.159: 22]: sudo rm -rf /home/git_dir/

2023-05-31 00:42:58,102 - log.my_log - INFO - [143.198.94.159: 22]: sudo mkdir -p /home/git_dir

2023-05-31 00:43:00,036 - log.my_log - INFO - [143.198.94.159: 22]: git clone https://github.com/wcg14231022/v2ray_auto.git /home/git_dir/v2ray_auto

2023-05-31 00:43:00,036 - log.my_log - INFO - [143.198.94.159: 22]:
Command error: Cloning into '/home/git_dir/v2ray_auto'...

2023-05-31 00:43:00,036 - log.my_log - INFO - 克隆v2ray-auto代码完成
2023-05-31 00:43:00,036 - log.my_log - INFO - 开始安装python依赖
2023-05-31 00:43:00,036 - log.my_log - INFO - 安装python依赖命令: sudo pip install -r /home/git_dir/requirements.txt
2023-05-31 00:43:02,038 - log.my_log - INFO - [143.198.94.159: 22]: sudo pip install -r /home/git_dir/requirements.txt

2023-05-31 00:43:02,038 - log.my_log - INFO - [143.198.94.159: 22]:
Command error: ERROR: Could not open requirements file: [Errno 2] No such file or directory: '/home/git_dir/requirements.txt'

2023-05-31 00:43:02,039 - log.my_log - INFO - 安装python依赖完成
2023-05-31 00:43:02,039 - log.my_log - INFO - 开始自动配置v2ray服务
2023-05-31 00:43:02,039 - log.my_log - INFO - 配置命令: cd /home/git_dir/v2ray_auto && sudo python3 /home/git_dir/v2ray_auto/auto_install_v2ray.py
2023-05-31 00:43:14,371 - log.my_log - INFO - [143.198.94.159: 22]: cd /home/git_dir/v2ray_auto && sudo python3 /home/git_dir/v2ray_auto/auto_install_v2ray.py
2023-05-30 16:43:03,325 - log.my_log - INFO - 开始自动安装V2Ray...
2023-05-30 16:43:03,326 - log.my_log - INFO - 生成的uuid: 9d9529c7-c0b1-4f9f-b7b9-a24d720627f3
2023-05-30 16:43:03,326 - log.my_log - INFO - 获取随机端口：
2023-05-30 16:43:03,326 - log.my_log - INFO - 随机端口为: 15023
2023-05-30 16:43:03,550 - log.my_log - INFO - 本机公网IP: 143.198.94.159
info: Stop the V2Ray service.
removed: /usr/local/bin/v2ray
removed: /usr/local/share/v2ray
removed: /etc/systemd/system/v2ray.service
removed: /etc/systemd/system/v2ray@.service
removed: /etc/systemd/system/v2ray.service.d
removed: /etc/systemd/system/v2ray@.service.d
Please execute the command: systemctl disable v2ray
You may need to execute a command to remove dependent software: dnf remove curl unzip
info: V2Ray has been removed.
info: If necessary, manually delete the configuration and log files.
info: e.g., /usr/local/etc/v2ray and /var/log/v2ray/ ...

info: Installing V2Ray v5.5.0 for x86_64
Downloading V2Ray archive: https://github.com/v2fly/v2ray-core/releases/download/v5.5.0/v2ray-linux-64.zip
Downloading verification file for V2Ray archive: https://github.com/v2fly/v2ray-core/releases/download/v5.5.0/v2ray-linux-64.zip.dgst
info: Extract the V2Ray package to /tmp/tmp.uyo5Uzh1c0 and prepare it for installation.
info: Systemd service files have been installed successfully!
warning: The following are the actual parameters for the v2ray service startup.
warning: Please make sure the configuration file path is correctly set.
# /etc/systemd/system/v2ray.service
[Unit]
Description=V2Ray Service
Documentation=https://www.v2fly.org/
After=network.target nss-lookup.target

[Service]
User=nobody
CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
NoNewPrivileges=true
ExecStart=/usr/local/bin/v2ray run -config /usr/local/etc/v2ray/config.json
Restart=on-failure
RestartPreventExitStatus=23

[Install]
WantedBy=multi-user.target

# /etc/systemd/system/v2ray.service.d/10-donot_touch_single_conf.conf
# In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there.
# Or all changes you made will be lost!  # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html
[Service]
ExecStart=
ExecStart=/usr/local/bin/v2ray run -config /usr/local/etc/v2ray/config.json

installed: /usr/local/bin/v2ray
installed: /usr/local/share/v2ray/geoip.dat
installed: /usr/local/share/v2ray/geosite.dat
installed: /etc/systemd/system/v2ray.service
installed: /etc/systemd/system/v2ray@.service
removed: /tmp/tmp.uyo5Uzh1c0
info: V2Ray v5.5.0 is installed.
You may need to execute a command to remove dependent software: dnf remove curl unzip
Please execute the command: systemctl enable v2ray; systemctl start v2ray

2023-05-30 16:43:09,595 - log.my_log - INFO - stop v2ray
2023-05-30 16:43:09,622 - log.my_log - INFO - 
2023-05-30 16:43:09,622 - log.my_log - INFO - stop v2ray finished
2023-05-30 16:43:09,622 - log.my_log - INFO - start v2ray
start v2ray


start v2ray finished
2023-05-30 16:43:10,517 - log.my_log - INFO - start v2ray finished
2023-05-30 16:43:10,519 - log.my_log - INFO - vmess_url: vmess://eyJ2IjogIjIiLCAicHMiOiAid2NnXzE0My4xOTguOTQuMTU5IiwgImFkZCI6ICIxNDMuMTk4Ljk0LjE1OSIsICJwb3J0IjogMTUwMjMsICJpZCI6ICI5ZDk1MjljNy1jMGIxLTRmOWYtYjdiOS1hMjRkNzIwNjI3ZjMiLCAiYWlkIjogMCwgIm5ldCI6ICJ0Y3AiLCAidHlwZSI6ICJub25lIiwgImhvc3QiOiAiIiwgInBhdGgiOiAiIiwgInRscyI6ICIifQ==
2023-05-30 16:43:12,931 - log.my_log - INFO - 邮件发送成功

2023-05-31 00:43:14,371 - log.my_log - INFO - 配置结果: 2023-05-30 16:43:03,325 - log.my_log - INFO - 开始自动安装V2Ray...
2023-05-30 16:43:03,326 - log.my_log - INFO - 生成的uuid: 9d9529c7-c0b1-4f9f-b7b9-a24d720627f3
2023-05-30 16:43:03,326 - log.my_log - INFO - 获取随机端口：
2023-05-30 16:43:03,326 - log.my_log - INFO - 随机端口为: 15023
2023-05-30 16:43:03,550 - log.my_log - INFO - 本机公网IP: 143.198.94.159
info: Stop the V2Ray service.
removed: /usr/local/bin/v2ray
removed: /usr/local/share/v2ray
removed: /etc/systemd/system/v2ray.service
removed: /etc/systemd/system/v2ray@.service
removed: /etc/systemd/system/v2ray.service.d
removed: /etc/systemd/system/v2ray@.service.d
Please execute the command: systemctl disable v2ray
You may need to execute a command to remove dependent software: dnf remove curl unzip
info: V2Ray has been removed.
info: If necessary, manually delete the configuration and log files.
info: e.g., /usr/local/etc/v2ray and /var/log/v2ray/ ...

info: Installing V2Ray v5.5.0 for x86_64
Downloading V2Ray archive: https://github.com/v2fly/v2ray-core/releases/download/v5.5.0/v2ray-linux-64.zip
Downloading verification file for V2Ray archive: https://github.com/v2fly/v2ray-core/releases/download/v5.5.0/v2ray-linux-64.zip.dgst
info: Extract the V2Ray package to /tmp/tmp.uyo5Uzh1c0 and prepare it for installation.
info: Systemd service files have been installed successfully!
warning: The following are the actual parameters for the v2ray service startup.
warning: Please make sure the configuration file path is correctly set.
# /etc/systemd/system/v2ray.service
[Unit]
Description=V2Ray Service
Documentation=https://www.v2fly.org/
After=network.target nss-lookup.target

[Service]
User=nobody
CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE
NoNewPrivileges=true
ExecStart=/usr/local/bin/v2ray run -config /usr/local/etc/v2ray/config.json
Restart=on-failure
RestartPreventExitStatus=23

[Install]
WantedBy=multi-user.target

# /etc/systemd/system/v2ray.service.d/10-donot_touch_single_conf.conf
# In case you have a good reason to do so, duplicate this file in the same directory and make your customizes there.
# Or all changes you made will be lost!  # Refer: https://www.freedesktop.org/software/systemd/man/systemd.unit.html
[Service]
ExecStart=
ExecStart=/usr/local/bin/v2ray run -config /usr/local/etc/v2ray/config.json

installed: /usr/local/bin/v2ray
installed: /usr/local/share/v2ray/geoip.dat
installed: /usr/local/share/v2ray/geosite.dat
installed: /etc/systemd/system/v2ray.service
installed: /etc/systemd/system/v2ray@.service
removed: /tmp/tmp.uyo5Uzh1c0
info: V2Ray v5.5.0 is installed.
You may need to execute a command to remove dependent software: dnf remove curl unzip
Please execute the command: systemctl enable v2ray; systemctl start v2ray

2023-05-30 16:43:09,595 - log.my_log - INFO - stop v2ray
2023-05-30 16:43:09,622 - log.my_log - INFO - 
2023-05-30 16:43:09,622 - log.my_log - INFO - stop v2ray finished
2023-05-30 16:43:09,622 - log.my_log - INFO - start v2ray
start v2ray


start v2ray finished
2023-05-30 16:43:10,517 - log.my_log - INFO - start v2ray finished
2023-05-30 16:43:10,519 - log.my_log - INFO - vmess_url: vmess://eyJ2IjogIjIiLCAicHMiOiAid2NnXzE0My4xOTguOTQuMTU5IiwgImFkZCI6ICIxNDMuMTk4Ljk0LjE1OSIsICJwb3J0IjogMTUwMjMsICJpZCI6ICI5ZDk1MjljNy1jMGIxLTRmOWYtYjdiOS1hMjRkNzIwNjI3ZjMiLCAiYWlkIjogMCwgIm5ldCI6ICJ0Y3AiLCAidHlwZSI6ICJub25lIiwgImhvc3QiOiAiIiwgInBhdGgiOiAiIiwgInRscyI6ICIifQ==
2023-05-30 16:43:12,931 - log.my_log - INFO - 邮件发送成功

2023-05-31 00:43:14,372 - log.my_log - INFO - 自动配置v2ray服务完成
2023-05-31 00:43:14,372 - log.my_log - INFO - 获取到的vmess: vmess://eyJ2IjogIjIiLCAicHMiOiAid2NnXzE0My4xOTguOTQuMTU5IiwgImFkZCI6ICIxNDMuMTk4Ljk0LjE1OSIsICJwb3J0IjogMTUwMjMsICJpZCI6ICI5ZDk1MjljNy1jMGIxLTRmOWYtYjdiOS1hMjRkNzIwNjI3ZjMiLCAiYWlkIjogMCwgIm5ldCI6ICJ0Y3AiLCAidHlwZSI6ICJub25lIiwgImhvc3QiOiAiIiwgInBhdGgiOiAiIiwgInRscyI6ICIifQ==
